<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Document</title>
</head>

<body>
  <form onsubmit="uploadFile()" action="javascript:void(0)" enctype="multipart/form-data" method="POST">
    <input type="text" id="identity" value="201702102" placeholder="ID"><br />
    <select id="type">
      <option value="tugasakhir">tugasakhir</option>
    </select><br />
    <input type="file" id="files"><br />
    <button type="submit">Upload</button>
  </form>
  <script src="https://unpkg.com/axios/dist/axios.min.js"></script>
  <script>
    const uploadFile = () => {
      let timestamp = new Date();
      let identity = document.getElementById('identity').value;
      let type = document.getElementById('type').value;
      let series = `${timestamp.getFullYear()}${timestamp.getMonth()}${timestamp.getDate()}${timestamp.getHours()}${timestamp.getMinutes()}`;
      let file = document.getElementById('files');

      if (file.files.length > 0) {
        const berkas = file.files[0];
        const reader = new FileReader();

        reader.onload = async (event) => {
          let data = {
            identity: identity,
            type: type,
            series: series,
            typefile: berkas.name.split('.').pop(),
            file: event.target.result.split(';base64,').pop(),
          }
          
          await axios.post(`http://opac.politekniklp3i-tasikmalaya.ac.id:3032/upload`,{
            data: data,
          })
          .then((response) => {
            console.log(response);
          })
          .catch((error) => {
            console.log(error);
          });

        };

        reader.readAsDataURL(berkas);
      }
    }
  </script>
</body>

</html>